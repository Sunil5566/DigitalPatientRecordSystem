<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details - Doctor</title>
    <link rel="stylesheet" th:href="@{/css/doctor.css}">
</head>
<body>

<div class="topbar">
    Doctor Dashboard >> Patient Details
    <div>
        <a href="/doctor/patients" style="color: white; margin-right: 10px;">Back to Patients</a>
        <a href="/logout" class="logout-btn">Logout</a>
    </div>
</div>

<div class="container">
    <h2>Patient Information</h2>
    <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
        <p><strong>Name:</strong> <span th:text="${patient.firstName + ' ' + patient.lastName}"></span></p>
        <p><strong>Gender:</strong> <span th:text="${patient.gender}"></span></p>
        <p><strong>Age:</strong> <span th:text="${patient.age}"></span></p>
        <p><strong>Contact:</strong> <span th:text="${patient.contact}"></span></p>
        <p><strong>Address:</strong> <span th:text="${patient.address}"></span></p>
    </div>

    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
        <h3>Medical Records</h3>
        <a th:href="@{/doctor/patient-record/add(patientId=${patient.id})}" style="background: #0b8043; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">Add New Record</a>
    </div>

    <div th:each="record : ${records}" style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
            <h4 th:text="${'Record #' + record.id + ' - ' + record.visitType}"></h4>
            <div>
                <a th:href="@{/doctor/patient-record/{id}/edit(id=${record.id})}" style="background: #1a73e8; color: white; padding: 5px 10px; text-decoration: none; border-radius: 3px; margin-right: 5px;">Edit</a>
                <form th:action="@{/doctor/patient-record/{id}/delete(id=${record.id})}" method="post" style="display: inline;">
                    <button type="submit" style="background: #d93025; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;" onclick="return confirm('Are you sure you want to delete this record?')">Delete</button>
                </form>
            </div>
        </div>
        <p><strong>Date:</strong> <span th:text="${#temporals.format(record.createdAt, 'yyyy-MM-dd HH:mm')} ?: ${record.createdAt}"></span></p>
        <p th:if="${record.diagnosis}"><strong>Diagnosis:</strong> <span th:text="${record.diagnosis}"></span></p>
        <p th:if="${record.prescriptions}"><strong>Prescriptions:</strong> <span th:text="${record.prescriptions}"></span></p>
        <p th:if="${record.labResults}"><strong>Lab Results:</strong> <span th:text="${record.labResults}"></span></p>
        <p th:if="${record.visitNotes}"><strong>Visit Notes:</strong> <span th:text="${record.visitNotes}"></span></p>
        <p th:if="${record.remarks}"><strong>Remarks:</strong> <span th:text="${record.remarks}"></span></p>
    </div>

    <div th:if="${#lists.isEmpty(records)}" style="background: white; padding: 20px; border-radius: 10px; text-align: center; color: #666;">
        No medical records found for this patient.
    </div>

    <h3 style="margin-top: 30px;">Appointments</h3>
    <div th:each="appointment : ${appointments}" style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px;">
        <p><strong>Date & Time:</strong> <span th:text="${appointment.appointmentDateTime != null ? #temporals.format(appointment.appointmentDateTime, 'yyyy-MM-dd HH:mm') : 'N/A'}"></span></p>
        <p><strong>Status:</strong> <span th:text="${appointment.status}"></span></p>
        <p th:if="${appointment.reason}"><strong>Reason:</strong> <span th:text="${appointment.reason}"></span></p>
    </div>
</div>

</body>
</html>

